# SERVLET_JSP 20200973 김영재

### 2023년 9월 6일 : 프로젝트 환경 설정, HELLO WORLD 확인 안료, 쇼핑몰 메인 페이지 - 2주차

기존 index.jsp 파일 body태그 안으로 부트스트랩 ui를 적용하여 메뉴바와 점보트론, 텍스트 컨테이너, 하단 영역을 만들었다.
한글 깨짐 문제를 해결하기 위해서 파일의 첫 시작은 페이지 지시자를 사용하여 HTML 콘텐츠를 생성하겠고, UTF-8 문자 집합을 사용한다고 정하였다.
최하단 상태바에 날짜를 출력하는 자바 코드를 스크립트 릿 안에 작성하였고, 자바 라이브러리를 사용하기위해 import문을 사용하여 클래스 컴파일 에러 문제를 해결하였다.

### 2023년 9월 13일 : 쇼핑몰 메인 페이지 모듈화 완료 - 3주차

2주차에 만들었던 index.jsp의 메인화면을 파일로 분리했다.
기존 index.jsp에서 body태그안에 내용을 include 지시문을 사용하여 파일을 불러오는 것으로 수정하였다.
기존 부트스트랩 링크를 새로운 링크로 업데이트해주고, index.jsp의 메인화면을 3가지로 분류하였다.
top_menu.jsp에는 index.jsp에 작성하였던 메뉴바를 넣어주고, body_main.jsp에는 텍스트 컨테이너를 넣어주고, 
footer.jsp에는 날짜를 출력하는 최하단 상태바를 넣어주었다.
주제를 의류 쇼핑몰로 잡아 의류 쇼핑몰에 어울리는 이미지 배너를 1개 다운받아 image 폴더를 만들어 업로드하였다.
최상단 배너 영역을 따로 분리하여 top_banner.jsp를 만들었다. index.jsp에는 top_banner.jsp를
include 지시문을 사용하여 파일을 불러오게 하였고, top_banner.jsp는 img태그를 작성하였다.
top_menu.jsp의 메뉴바에 드롭다운 메뉴를 추가하고 로고 이미지를 삽입하였다.
그리고 로고 이미지 옆에는 가로로 로그인, 회원가입, 고객센터 메뉴가 나열되게 하였다.
body_main.jsp에는 큰 텍스트를 넣고 하단 오버레이 이미지를 직접 만들어 img태그 안에 넣고,
오버레이 이미지 아래에는 목록 그룹을 만들었다.
최하단 footer.jsp에는 이름, 학번, 이메일 주소를 작성하였고, 현재 접속 시간을 알려주는 2주차에 사용했던
스크립트 릿 안 Date 코드를 가져와 작성하였다.
index.jsp에 현재 페이지 버퍼 용량과 남은 페이지 버퍼 용량을 알려주게 버퍼 처리를 하였다.
<br>
<br>
 * 연습문제 -> 기존 jsp 파일 스크립트 릿 안에 작성하였던 시간 출력 코드는 새로운 java 파일을 만들어 분리시켰다.
그리고 footer.jsp 헤더부분에 import문으로 이 코드를 가져오게 하여 출력하게 하였다. 그렇지만  강의안대로 시간 출력 코드를 작성할 시 정확한 대한민국의 시간이 뜨지 않아 새로운 코드로 작성하였다.
패키지를 선언하고, 라이브러리를 임포트하고, 한국 표준시로 시간대를 설정하고 Calendar 클래스를 사용하여 
현재 시간을 시, 분, 초로 분리한 후 최종 시간 문자열을 만들어 반환하였다.

### 2023년 9월 27일 : 쇼핑몰 상품 목록 페이지 추가 - 5주차

상품화면을 오버레이 이미지 위에 추가하였다. 상품 목록을 멤버 변수로 정의해주는 Product.java와 상품을 저장하는 ProductRepository.java 파일을 만들었다.
dto 패키지를 생성하여 Product.java 파일을 만들고 상품 아이디, 상품명, 상품 가격 등을 변수로 정의하고 set, get 메소드를 구현하였다.
dao 패키지를 생성하여 ProductRepository.java 파일을 만들고 dto 패키지의 Product를 가져와 상품을 저장하였다. 원하는 제품으로 상품 3개를 입력하였다.
body_main.jsp를 수정하는데 dto 패키지의 Product 패키지 연동을 해주고, 자바 빈 클래스를 설정하였다. ArrayList를 이용하여 리스트에 상품 전체 정보를 얻어와 출력하게 하였다.
<br>
<br>
* 연습문제 -> 같은 방법으로 6개의 상품을 더하여 총 9개의 상품을 저장하여 출력하였다.
기존 image 폴더에 product 폴더를 만들어서 9개의 이미지를 저장하였다. 그리고, 자바 빈즈를 활용하여 이미지를 추가하였다.

### 2023년 10월 4일 : 쇼핑몰 상품 상세 페이지 추가 - 6주차

5주차에 만든 ProductRepository.java 파일을 수정하였다.
기존에는 getAllProducts 메소드로 전체 상품 정보를 리턴했는데 링크 클릭을 통해 요청된 상품 id를 리턴하는 새로운 메소드를 추가하였다.
Product 객체를 저장하는 리스트 listOfProducts를 순회하여 각각의 객체에 대해 productId가 일치하는지를 확인하는 코드를 구현하였다.
body_main.jsp를 수정하여 마우스로 링크를 클릭하면 새로운 페이지가 뜨는 기능을 구현하였다.
새로운 파일 product_detail.jsp를 만들었는데 이 파일은 상/하단 메뉴를 포함하여 index.jsp와 동일한 화면을 보여주게 하였다.
index.jsp와 다른 점은 이 파일은 상품의 상세 정보만 표시한다는 것이다. 내장 객체를 활용하여 정보를 받았다.
정상적이지 않은 상품 또는 id가 잘못 전달될 수 있기 때문에 이를 위해 예외 처리를 위한 exception 폴더를 만들어 product_not_found.jsp 파일을 생성하였다. 이 파일은 top_banner.jsp 파일과 top_menu.jsp 파일을 include하여 메뉴바를 index.jsp 파일과 동일하게 하였다. 화면에 뜨는 글만 바꿔서 에러 페이지로 만들었다.
<br>
<br>
* 연습문제 -> 전체 상품 상세페이지, 메인 페이지도 예외처리 하였다. index.jsp에 대한 예외처리 페이지를 만들었다. web.xml에서 error-page, error-code:404, location 태그를 사용하고 파일명은 exception 폴더 안에 main_server_downtime.jsp를 만들어 입력했다.

### 2023년 10월 11일 : 쇼핑몰 상품 등록 추가 - 7주차

지금까지 만든 파일들은 사용자용 페이지들인데, 관리자용 페이지를 생성하였다.
admin 폴더를 생성하고 기존 파일들을 복사하여 파일 이름들의 뒤에 ad를 추가하여 관리자용 파일로 명명하였다.
top_menu.jsp에 메뉴 링크를 관리자모드 하나 추가하였고, 클릭하면 index_ad.jsp 파일로 가게 하였다.
관리자용 메인 페이지의 메뉴 링크를 모두 수정해주었고, product_add.jsp 파일을 새로 작성하였다.
쇼핑몰의 상품을 등록하는 폼 화면이다. post 방식으로 전송하였다.
product_add_process.jsp를 만들어 Prouct, ProductRepository 클래스를 import하였고, request.getParameter()를 사용하여 폼으로부터 전송된 데이터를 각각의 변수에 저장하였다. 마지막은 index_ad.jsp 페이지로 리다이렉트하였다.
ProductRepository.java를 수정하였는데, 데이터 추가를 위해 객체 변수 인스턴스를 사용하였다.
또, body_main.jsp 파일에서 기존에 사용했던 자바 빈즈를 제거하고 import 방식으로 dao 패키지의 ProductRepository를 import 하는것으로 수정하였다. 현재 생성된 객체의 상품 목록을 출력하게 하였고, 파일 및 폴더 변경으로 경로를 수정하였다.
product_detail_ad.jsp는 기존에 상품 상세 페이지로 또한 자바 빈즈를 제거하고 import 방식으로 변경하였다.
Product.java와 ProductRepository.java 파일에서 이미지 파일 추가를 위해 파일명 변수와 Set, Get 메소드를 추가하였다.
body_main.jsp 파일의 메인 화면 이미지 로드 부분에서 product 객체의 getFilename() 메서드를 호출하여 해당 제품의 이미지 파일 이름을 가져온 후 그 값을 사용하게 코드를 바꿔주었다.
파일 업로드를 위한 라이브러리 cos.jar을 lib 폴더 안에 업로드하였다. 그리고 product_detail.jsp 파일에서도 이미지 로드 부분을 동일하게 바꿔주었다.
product_add.jsp 파일에서 파일 업로드를 위해 폼 전송 타입을 바꿔주었고, 이미지를 등록할 수 있게 input type file을 만들어주었다.
product_add_process.jsp에서 라이브러리 사용을 위해 import문을 추가하고 파일 업로드에 필요한 각 변수를 초기화하였다. realFolder로 웹 어플리케이션 상의 실제 경로를 얻어와 인코딩 타입과 최대 업로드 파일 크기를 설정하였다. 파일 업로드 시 동일한 이름의 파일이 존재하는지, 파일 이름을 자동으로 변경하는 정책을 제공하는 클래스를 사용하였고, 파일 업로드를 처리하기 위해 MultipartRequest 클래스를 사용하였다.

### 2023년 10월 25일 : 쇼핑몰 로그인 기능 추가 - 9주차

입력값을 필터링해주는 validation.js 파일을 최상위에 js 폴더를 새로 만들어 그 안에 추가하였다.
각각의 입력 폼 요소를 getElementById 메소드를 사용하여 가져와 상품 코드를 정규 표현식으로 검사하였다.
상품 가격과 재고 수를 체크하고 폼을 제출하는 코드를 구현하였다.
product_add.jsp 파일에 validation.js 파일을 연동하였고, 자바 스크립트 체크를 위해서 상품 코드, 상품명, 가격, 재고 수의 id 값을 수정하였다.
.XML 파일을 수정하였다. 탐캣 내 파일을 수정하였다. 그룸 ide 터미널 상에서 직접 리눅스 vi를 이용하였다. cd 명령으로 폴더 이동을 하여 tomcat_users.xml 파일을 확인하였다.
이 파일을 수정하기 전에 먼저 원본 파일을 백업하였고 수정사항으로는 주석을 삭제하여 코드를 활성화시키고 내용을 수정하였다. vi tomcat-users.xml을 입력하여 del 키로 주석을 삭제한 것이다.
수정하는 방법으로 키보드 a를 눌렀고, rolename과 username으로 admin을 추가하여 admin에 대한 아이디와 비밀번호를 추가하였다.
수정을 완료하여 shift와 콜론을 동시에 누르고 wq를 입력하고 엔터를 하여 수정을 완료하였다.
탐캣 서버를 재시작하고 web.xml을 수정하였다. adminㅇ 대한 보안 규칙을 추가하기 위해 security-role태그에 admin을 추가하고, url-pattern태그로 제약 조건이 적용될 url 패턴을 지정해주었다.
그리고 웹 리소스에 대한 접근 권한도 admin 역할만 접근할 수 있도록 제한해주었다.
로그인 설정을 정의하고 form 인증 방법에 대한 추가적인 구성을 지정하는 태그를 추가하였다.
기존 top_menu.jsp 파일을 수정하였다.
login.jsp와 login_failed.jsp 파일을 새로 추가하였다.
로그인과 로그인 실패 페이지이다. 최상위 login 폴더를 만들어서 그 안에 생성하였다.
보안 인증에 action으로 j_security_check를 지정하였다.
로그인이 실패하면 다시 로그인 페이지를 로딩하는 코드를 작성하였고, 
logout.jsp를 새로 생성하여 로그아웃 버튼을 클릭하면 invalidate()를 사용하여 현재 세션 객체를 전체 삭제하고 상품 등록 페이지인 product_add.jsp파일로 sendRedirect하였다.
로그아웃 버튼은 상품 등록 페이지의 등록 버튼 아래에 추가하였다.
<br>
<br>
* 연습문제 -> 관리자 페이지 메뉴를 클릭하면 로그인을 수행하도록 변경하였다.
role은 admin으로 동일하고, 비밀번호를 123123에서 123654로 변경하였다. 서버 내 설정 파일도 수정해주었다.
상품 등록 페이지의 로그아웃 버튼을 없앴고, 
관리자용 페이지 메뉴바에 로그아웃 메뉴를 만들어 관리자용 페이지에 접근하고 나서 로그아웃을 원하면 굳이 상품 등록 페이지로 가지 않고 바로 로그아웃 할 수 있게 하였다.

### 2023년 11월 1일 : 세션 및 장바구니 기능 추가 - 10주차

Product.java 클래스를 수정하였다. 기존 코드에 장바구니에 담은 개수를 담을 멤버 변수를 추가하고, set, get 메소드를 추가하였다.
product_detail.jsp 파일을 수정하였다. 장바구니 추가를 묻는 알림창 기능을 가진 함수를 confirm 함수를 사용하여 script 태그 안에 구현하였다.
그리고, 기존 상품 목록 옆에 상품 주문을 삭제하고, 상품 주문하기, 장바구니 링크를 추가하였다.
cart 폴더를 생성하고 장바구니 등록 페이지인 product_cart_add.jsp 파일을 생성하여 ArrayList, Product, ProductRepository 클래스를 가져와 request 요청으로 제품 id를 가져왔다.
또, 제품을 검색하여 찾을 수 없으면 product_not_found 페이지로 리다이렉트하고, 모든 제품을 가져와서 세션에 저장된 사용자의 장바구니를 업데이트하였다.
장바구니 화면 페이지인 product_cart.jsp 파일을 생성하여 리스트 상품 정보로부터 가격과 수량으로 가격 총액을 계산하는 페이지로 만들었다.
장바구니에서 삭제하는 기능을 담은 페이지 product_cart_remove.jsp를 만들었다. 제품 id를 가져오고 인스턴스를 생성하고, 제품을 검색하고, 장바구니 목록을 가져와 제품을 찾아 제거하고, 삭제한 후 product_cart.jsp 페이지로 리다이렉트하는 코드를 구현하였다.
product_cart_remove_all.jsp 페이지는 cartid 매개변수를 장바구니 아이템에서 가져와 상품의 전체 목록을 삭제하는 기능을 구현하였다. 전체 삭제하기 버튼을 누르면 session.invalidate()에 의해 다른 값으로 초기화된다.
<br>
<br>
* 연습문제 -> 첫 번째, 날짜 관련하여 클래스 에러가 나지는 않았지만, footer.jsp에 직접 클래스 연동을 추가하였다.
그리고 두 번째, 장바구니 페이지 상단 로그 이미지가 깨지기 때문에 cart용 image 폴더를 새로 만들어서 경로를 수정해주었다.
세 번째, 세션을 전체 삭제하고 뒤로 가기 한 다음 다시 특정 상품을 선택하여 삭제를 하면 에러가 난다.
이것을 해결하기 위해 기존 product_cart_remove.jsp 파일에서 
장바구니 목록이 null인지 확인하는 if (cartList == null)을 하여 
장바구니 목록이 null이거나 아직 생성되지 않은 경우 ArrayList를 생성하고 새로 생성한 또는 이미 존재하던 cartList를 세션에 cartList라는 키로 설정해주는 코드를 추가 구현해주었다.
이로써 에러가 더이상 발생하지 않는다. 네 번째, 일반 상품 상세 페이지와 관리자 페이지의 상세 페이지는 경로가 살짝 다르기 때문에 수정을 해주었다.

### 2023년 11월 8일 : 쇼핑몰 주문 처리 페이지 추가 - 11주차



### 2023년 11월 15일 : 쇼핑몰 상품 관리 페이지 추가(1) - 12주차



### 2023년 11월 22일 : 쇼핑몰 상품 관리 페이지 추가(2) - 13주차



### 2023년 11월 29일 : 쇼핑몰 게시판 추가 - 14주차


